<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
      PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
   "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
   
<mapper namespace="mapper.community">

	<resultMap type="communityVO" id="communityResult">
		<result property="board_num" column="board_num"/>
		<result property="board_title" column="board_title"/>
		<result property="board_genre" column="board_genre"/>
		<result property="board_like" column="board_like"/>
		<result property="board_date" column="board_date"/>
		<result property="nickname" column="nickname"/>
	</resultMap>
	
	<select id="community_list_view" resultMap="communityResult">
		<![CDATA[
			select board_num, board_title, board_genre, board_like, board_date, j.nickname  
			from boardtbl b, jointbl j where b.id=j.id 
			order by board_num desc
		]]>
	</select>
	
	<select id="max_num" resultType="_int">
		<![CDATA[
			SELECT count(*) as max from boardtbl
		]]>
	</select>
	
	<insert id="addArticle" parameterType="communityVO">
		<![CDATA[
			INSERT INTO boardtbl(board_num, board_title, id, board_like, board_view, board_genre, board_content) 
			VALUES((SELECT NVL(MAX(board_num),0)+1 FROM boardtbl), #{board_title}, #{id}, 0, 0, #{board_genre}, #{board_content})
		]]>
	</insert>
	
	<select id="viewArticle" resultType="communityVO" parameterType="int">
		<![CDATA[
			SELECT * FROM boardtbl WHERE board_num=#{board_num}
		]]>
	</select>
	
</mapper>